<?xml version="1.0" encoding="UTF-8"?>
<!--
vim: ts=4:sw=4
-->
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>com.facebook.mojo</groupId>
        <artifactId>fbthrift-maven-plugin-root</artifactId>
        <version>2.2-SNAPSHOT</version>
    </parent>

    <artifactId>fbthrift-maven-plugin-example</artifactId>
    <packaging>jar</packaging>

    <name>${project.artifactId}</name>
    <description>
        An example of how to use com.facebook.mojo:fbthrift-maven-plugin
    </description>

    <properties>
        <!-- Given this is not production code, intended for internal use ONLY,
             it's easier to disable these checks for now -->
        <basepom.check.fail-enforcer>false</basepom.check.fail-enforcer>
        <basepom.check.fail-findbugs>false</basepom.check.fail-findbugs>
        <basepom.check.fail-checkstyle>false</basepom.check.fail-checkstyle>
    </properties>

    <dependencies>
        <!--
            That's kinda funny, but to make it compile on laptops you can include both
            fbthrift and apache thrift into classpath. On devserver thrift compiler is
            fbthrift compiler, while on laptops it's apache thrift compiler.
            Keep in mind that we only care about files being generated here, actual
            implementation of those files does not matter for this test project.
        -->
        <dependency>
            <groupId>org.apache.thrift</groupId>
            <artifactId>libthrift</artifactId>
            <version>0.9.3-fb-202010011104-17919264dff5</version>
        </dependency>
        <dependency>
            <groupId>com.facebook</groupId>
            <artifactId>thrift</artifactId>
            <version>12.0-202007130921-ead26c0722ee</version>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>1.7.30</version>
        </dependency>
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>javax.servlet-api</artifactId>
            <version>4.0.0</version>
        </dependency>
        <dependency>
            <groupId>commons-codec</groupId>
            <artifactId>commons-codec</artifactId>
            <version>1.11</version>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>com.facebook.mojo</groupId>
                <artifactId>fbthrift-maven-plugin</artifactId>
                <version>2.2-SNAPSHOT</version>
                <configuration>
                    <compiler>
                      <extraOptions>
                        <option>-allow-neg-keys</option>
                        <option>-r</option>
                      </extraOptions>
                    </compiler>
                    <baseDirectory>${project.basedir}</baseDirectory>
                    <sources>
                        <param>Example1.thrift</param>
                    </sources>
                </configuration>
                <executions>
                    <execution>
                        <goals>
                            <goal>thrift-generate-sources</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>build-helper-maven-plugin</artifactId>
                <version>1.8</version>
                <executions>
                    <execution>
                        <phase>generate-sources</phase>
                        <goals>
                            <goal>add-source</goal>
                        </goals>
                        <configuration>
                            <sources>
                                <source>${project.build.directory}/generated-sources/gen-java</source>
                            </sources>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-dependency-plugin</artifactId>
                <configuration>
                    <ignoredUnusedDeclaredDependencies>
                        <ignoredUnusedDeclaredDependency>org.apache.thrift:libthrift</ignoredUnusedDeclaredDependency>
                        <ignoredUnusedDeclaredDependency>com.facebook:thrift</ignoredUnusedDeclaredDependency>
                        <ignoredUnusedDeclaredDependency>javax.servlet:javax.servlet-api</ignoredUnusedDeclaredDependency>
                        <ignoredUnusedDeclaredDependency>org.slf4j:slf4j-api</ignoredUnusedDeclaredDependency>
                        <ignoredUnusedDeclaredDependency>commons-codec:commons-codec</ignoredUnusedDeclaredDependency>
                    </ignoredUnusedDeclaredDependencies>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project>
